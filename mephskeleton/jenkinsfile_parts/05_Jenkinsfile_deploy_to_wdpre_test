       stage('Generate ZIP and UPLOAD BATCH') {
            steps
            {
              withCredentials([usernamePassword(credentialsId: 'cicd.sysops', usernameVariable: 'CICD_USER', passwordVariable: 'CICD_PASS')])
              {
                  withCredentials([usernamePassword(credentialsId: 'cicd.sysops.s3.deploy', usernameVariable: 'CICD_S3_USER', passwordVariable: 'CICD_S3_PASS')])
                   {
                    //milestone(6)
                      echo 'Desplegamos en TEST'
                      dir('./build_pipeline') {
                          sh './04_deploy_batch.sh -f jenkins  -e test'
                          script
                          {
                              LAST_GROUPNAME_WDPRE = readFile('./tmp/zip_s3_files/LAST_GROUPNAME_WDPRE.txt').trim()
                              LAST_ARTIFACT_WDPRE = readFile('./tmp/zip_s3_files/LAST_ARTIFACT_WDPRE.txt').trim()
                              LAST_VERSION_WDPRE = readFile('./tmp/zip_s3_files/LAST_VERSION_WDPRE.txt').trim()
                          }
                      }
                    }
              }
            }
       }

      stage('Deploy to env WDPRE') {
           steps
           {
               //milestone(7)
               echo 'Desplegamos en PRE lsdonains {' +  LAST_GROUPNAME_WDPRE + '}  {' + LAST_ARTIFACT_WDPRE + '} {' + LAST_VERSION_WDPRE + '}'
               dir('./build_pipeline') {
                   build job:'softbase/utils/deploy_wdpre_test', parameters: [[$class: 'StringParameterValue', name: 'GROUPNAME', value: LAST_GROUPNAME_WDPRE],[$class: 'StringParameterValue', name: 'ARTIFACT', value: LAST_ARTIFACT_WDPRE],[$class: 'StringParameterValue', name: 'VERSION', value: LAST_VERSION_WDPRE]]
               }
           }
      }